---
title: 浏览器中输入URL展示页面，发生了什么？
categories:
 - Browser
tags:
 - 浏览器请求页面
date: 2022-08-21
sidebar: 'auto'
---

## 前言
总览流程：
* 输入URL

## 输入URL
用户在地址栏输入关键字。<br/>
合法的URL ? 开始请求https://URL : 使用默认搜索引擎进行关键字搜索

## URL请求
浏览器进程通过IPC（进程通信）把URL请求发送给网络进程，网络进程接受到，发起URL请求。
1. 本地缓存检查 ? 返回资源给浏览器进程 : **DNS解析**。
2. 拿到请求域名的**服务器IP**，如果请求协议是https，还需要建立TLS（Transport Layer Security）连接。
3. 根据IP地址和目标服务器建立**TCP连接**。
4. 浏览器构建请求行、请求头（cookie等数据）向目标服务器发送构建的请求信息（**HTTP请求**）。
5. 目标服务器接受到请求信息，根据请求信息生成**响应数据**（响应行、响应头、响应体），发送给浏览器的**网络进程**。
6. 网络进程接受到响应行和响应头（统一为响应信息），开始解析响应数据。

### 重定向
如果网络进程接受到的响应信息中的状态码是**301 or 302**，代表需要浏览器**重定向到其他的URL**，此时网络进程从响应信息中的**Location字段**获取重定向的地址，**再次发起新的HTTPS or HTTP请求，重复上述的流程**。<br/>
如果服务器返回的响应信息中状态码是**200**，代表一切正常，浏览器可以继续处理请求。

### 响应数据类型
浏览器如何区分URL请求是一个正常的HTML or 下载请求呢？使用响应信息中的**Content-Type**字段进行区分。
* Content-Type: text/html<br/>
  告诉浏览器服务器返回的数据是HTML格式。
* Content-Type: application/octet-stream<br/>
  返回的数据是字节流类型的，一般浏览器按照下载类型来处理。<br/>

不同的Content-Type，浏览器后续的处理也会不同。<br/>
* 如果判断为下载类型 => 该请求会被提交给浏览器的下载管理器，同时URL请求的导航流程就此结束。
* 如果是HTML => 浏览器会继续进行导航流程，Chrome的页面渲染是运行在渲染进程中的，所以接下来需要开始**准备渲染进程**了。

## 总结