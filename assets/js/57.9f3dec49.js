(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{469:function(t,s,a){"use strict";a.r(s);var r=a(2),e=Object(r.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"前言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),s("p",[t._v("浏览器/服务器之间的通信重要的网络通讯协议 => HTTP（超文本传输协议）。")]),t._v(" "),s("h2",{attrs:{id:"http-0-9"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http-0-9"}},[t._v("#")]),t._v(" HTTP/0.9")]),t._v(" "),s("p",[t._v("早期需求 => 网络之间传递HTML超文本内容 => 所以诞生超文本传输协议。整体实现也相对简单，基于请求/响应模式，客户端请求、服务端返回数据。"),s("br"),t._v("\n具体流程：")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("HTTP基于TCP协议")]),t._v("，客户端基于IP、端口和服务器建立TCP连接（TCP三次握手）。")]),t._v(" "),s("li",[t._v("建立连接完毕 => 发送GET请求行信息（GET /index.html） => 获取index.html资源文件。")]),t._v(" "),s("li",[t._v("服务器接受请求信息 => 读取响应HTML文件 => 以ASCII字符流形式返回客户端。")]),t._v(" "),s("li",[t._v("HTML文件数据流传输完毕 => 断开连接。\n特点：")]),t._v(" "),s("li",[t._v("早期需求简单 => 用于传输体积很小的HTML文件。")]),t._v(" "),s("li",[s("strong",[t._v("只需一个请求行，无HTTP请求头、请求体")]),t._v("（一个请求行足以完整表达客户端需求）。")]),t._v(" "),s("li",[t._v("服务器无返回头信息，只需返回数据。（服务端无需告诉客户端太多信息）。")]),t._v(" "),s("li",[t._v("因为是HTML格式文件 => 返回的文件内容以ASCII字符流传输。")])]),t._v(" "),s("h2",{attrs:{id:"http-1-0"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http-1-0"}},[t._v("#")]),t._v(" HTTP/1.0")]),t._v(" "),s("p",[t._v("HTTP/0.9虽然简单，但是可以满足当时的需求了。时代在发展（1994年拨号上网、网景浏览器），万维网不局限在学术交流（用户更多？），万维网联盟（W3C）、HTTP-WG负责推进HTML、HTTP发展。浏览器不单单只有HTML文件了，出现了JavaScript、CSS、图片、音频、视频more...，所以需要解决一个新需求："),s("strong",[t._v("协议支持多种类型文件下载")]),t._v("，文件类型不局限于ASCII编码。")]),t._v(" "),s("h3",{attrs:{id:"实现多类型文件下载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#实现多类型文件下载"}},[t._v("#")]),t._v(" 实现多类型文件下载")]),t._v(" "),s("p",[t._v("多类文件面对的问题：")]),t._v(" "),s("ol",[s("li",[t._v("浏览器需要知道服务器返回的数据类型，由此针对不同数据类型进行处理。")]),t._v(" "),s("li",[t._v("浏览器需要知道服务器返回的文件类型编码，才能正确的读取文件。")]),t._v(" "),s("li",[t._v("浏览器需要知道服务器压缩方式，万维网支持的应用更多，单个文件的数据体量愈发庞大，服务器会对数据进行压缩传输。")]),t._v(" "),s("li",[t._v("浏览器需要告知服务器需要哪种语言版本的数据，因为万维网是全球的。")])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"title"}),s("p",[t._v("基于请求头、响应头进行协商，发起HTTP请求，请求头告知服务器期待返回的文件类型、文件压缩的方式、语言版本、文件编码类型。")])]),s("p",[t._v("浏览器、服务器之间基于HTTP通信，HTTP/0.9在建立连接后，发送类似GET /index.html的简单请求，没有别的方式告诉服务器更多信息（文件编码、类型），相应的服务器也是直接把数据返回给浏览器，也没有别的方式告知浏览器返回的数据更多详细的信息。所以为了让"),s("strong",[t._v("客户端、服务器通信承载更多信息")]),t._v("，HTTP/1.0引入"),s("strong",[t._v("请求头、响应头")]),t._v("，以Key-Value形式保存，当发送HTTP请求时，带上请求头信息、服务器返回数据，先返回响应头信息。"),s("br"),t._v("\n请求头：")]),t._v(" "),s("div",{staticClass:"language-json line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 期望服务器返回html类型文件")]),t._v("\naccept"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" text/html\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 期望服务器可以采用gzip/deflate/br其中的一种压缩方式")]),t._v("\naccept-encoding"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" gzip"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" deflate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" br\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 期望服务器返回的文件编码是ISO-8859-1/UTF-8 ")]),t._v("\naccept-Charset"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ISO"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("-8859")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("-1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("utf"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("-8")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 期望页面的优先语言是中文")]),t._v("\naccept-language"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" zh-CN"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("zh\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("p",[t._v("响应头：")]),t._v(" "),s("div",{staticClass:"language-json line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 告知浏览器最终的压缩类型")]),t._v("\ncontent-encoding"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" br\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 返回html文件、文件的编码类型UTF-8")]),t._v("\ncontent-type"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" text/html; charset=UTF"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("-8")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("h3",{attrs:{id:"特性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#特性"}},[t._v("#")]),t._v(" 特性")]),t._v(" "),s("ul",[s("li",[t._v("对多文件提供良好的支持。")]),t._v(" "),s("li",[t._v("引入状态码，通过响应行的方式告知浏览器。（有些请求服务器可能无法处理/出错）。")]),t._v(" "),s("li",[t._v("提供Cache机制，缓存已下载过的数据，减轻服务器压力。")]),t._v(" "),s("li",[t._v("支持服务器统计客户端基础信息（Windows、macOS的用户数量），在请求头中加入了用户代理的字段。")])]),t._v(" "),s("h2",{attrs:{id:"http-1-1"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http-1-1"}},[t._v("#")]),t._v(" HTTP/1.1")]),t._v(" "),s("h3",{attrs:{id:"增加持久连接"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#增加持久连接"}},[t._v("#")]),t._v(" 增加持久连接")]),t._v(" "),s("p",[t._v("HTTP/1.0每次通信都需要经历 => "),s("strong",[t._v("建立TCP连接、传输HTTP、断开TCP")]),t._v("。当初通信文件比较小，页面引用资源也不多，所以这种传输方式没啥问题，后期浏览器普及，页面中图片文件很多（几百个引用文件），如果下载每个文件都经历上述的三个步骤，开销很大。"),s("br"),t._v("\nHTTP/1.1增加了持久连接解决问题，其特性：")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("一个TCP连接可以传输多个HTTP请求")]),t._v("。只要浏览器服务器没有明确断开连接，该TCP连接会"),s("strong",[t._v("一直保持")]),t._v("。有效减少了TCP建立、断开的次数，减轻服务器压力，提升整个HTTP请求时长。")]),t._v(" "),s("li",[t._v("HTTP/1.1默认开启持久连接（无需额外设置请求头实现持久连接），若不需要请求头加上Connection: close")]),t._v(" "),s("li",[t._v("浏览器对于同域下，默认允许同时建立6个TCP连接。")])]),t._v(" "),s("h3",{attrs:{id:"客户端cookie、安全机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#客户端cookie、安全机制"}},[t._v("#")]),t._v(" 客户端Cookie、安全机制")]),t._v(" "),s("p",[t._v("HTTP/1.1引入了客户端Cookie机制和安全机制。")]),t._v(" "),s("h3",{attrs:{id:"对动态生成的内容的支持"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#对动态生成的内容的支持"}},[t._v("#")]),t._v(" 对动态生成的内容的支持")]),t._v(" "),s("p",[t._v("HTTP/1.0需要在响应头中设置完整的数据大小（Content-Length: 233），浏览器根据设置的数据大小来接收数据。时代在发展，很多页面的内容都是动态生成的，在传输数据之前并不知道最终的数据大小，这就导致了浏览器无法知道何时会接收完所有的文件数据。"),s("br"),t._v("\nHTTP/1.1引入Chunk transfer机制来解决，服务器将数据分割成若干个任意大小的数据块，每个数据块发送时会附上上个数据块的长度，"),s("strong",[t._v("最后使用一个零长度的块作为发送数据完成的标志")]),t._v("，这样就提供了对动态内容的支持。")]),t._v(" "),s("h3",{attrs:{id:"虚拟主机的支持"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#虚拟主机的支持"}},[t._v("#")]),t._v(" 虚拟主机的支持")]),t._v(" "),s("p",[t._v("HTTP/1.0每个域名绑定唯一的IP地址。所以一个服务器只支持一个域名。虚拟主机的发展需要实现一台物理主机绑定多个虚拟主机，每个虚拟主机有自己单独的域名，但是都公用同一个IP。"),s("br"),t._v("\nHTTP/1.1的请求头中增加了Host字段表示当前的域名地址，服务器可以根据不同的Host值做不同的处理。")]),t._v(" "),s("h3",{attrs:{id:"http管线化-已废弃"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http管线化-已废弃"}},[t._v("#")]),t._v(" HTTP管线化（已废弃）")]),t._v(" "),s("p",[t._v("持久连接的问题：需要等待前面的请求返回，才能进行下一次的请求，如果TCP通道某个请求未及时返回，就会造成后续请求阻塞（对头阻塞）。"),s("br"),t._v("\nHTTP/1.1提出管线化去解决队头阻塞 => 将多个HTTP请求批量打包提交给服务器，不够这种方式虽然实现批量发送请求，但是服务器依然需要根据请求顺序来回复浏览器的请求。FireFox、Chrome都做过管线化的试验，不过最终都放弃了管线化技术。")]),t._v(" "),s("h2",{attrs:{id:"总结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),s("ul",[s("li",[t._v("最初需求简单，0.9足以支持通信。")]),t._v(" "),s("li",[t._v("万维网发展，核心需求多文件类型下载，1.0引入请求头、响应头支持，额外的提供Cache、用户代理、状态码等基础信息通信。")]),t._v(" "),s("li",[t._v("继续发展，1.1增加持久连接提升连接效率，降低服务器开销，"),s("s",[t._v("管线化尝试")]),t._v("，额外的引入Cookie、虚拟机、动态内容支持等特性。")])])])}),[],!1,null,null,null);s.default=e.exports}}]);